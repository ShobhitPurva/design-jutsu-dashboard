<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Design Jutsu ‚Äî Command Center</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #141414;
            --bg-tertiary: #1a1a1a;
            --bg-card: #1e1e1e;
            --crimson: #A31621;
            --crimson-dark: #8B0000;
            --crimson-dim: #5a0d12;
            --text-primary: #f0e6e6;
            --text-secondary: #999999;
            --text-tertiary: #666666;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --blue: #3b82f6;
            --border: #2a2424;
            --spacing: 16px;
        }

        body {
            font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-primary);
            background-image: 
                repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(255,255,255,.02) 2px, rgba(255,255,255,.02) 4px),
                repeating-linear-gradient(90deg, transparent, transparent 2px, rgba(255,255,255,.02) 2px, rgba(255,255,255,.02) 4px);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            font-size: 15px;
        }

        /* Password Gate */
        .password-gate {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: var(--spacing);
        }

        .password-box {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: calc(var(--spacing) * 3) calc(var(--spacing) * 2);
            max-width: 400px;
            width: 100%;
            text-align: center;
        }

        .password-title {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: calc(var(--spacing) / 2);
            color: var(--crimson);
        }

        .password-subtitle {
            color: var(--text-secondary);
            margin-bottom: calc(var(--spacing) * 2);
            font-size: 0.9375rem;
            line-height: 1.5;
        }

        .password-input {
            width: 100%;
            padding: 14px var(--spacing);
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 1rem;
            margin-bottom: var(--spacing);
            transition: border-color 0.2s;
            min-height: 44px;
        }

        .password-input:focus {
            outline: none;
            border-color: var(--crimson);
        }

        .password-submit {
            width: 100%;
            padding: 14px;
            background: var(--crimson);
            border: none;
            border-radius: 6px;
            color: #ffffff;
            font-family: inherit;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
            min-height: 44px;
        }

        .password-submit:hover {
            background: var(--crimson-dark);
        }

        .password-error {
            color: var(--error);
            font-size: 0.875rem;
            margin-top: calc(var(--spacing) / 2);
            display: none;
        }

        .password-error.show {
            display: block;
        }

        /* Dashboard */
        .dashboard {
            display: none;
            min-height: 100vh;
        }

        .dashboard.unlocked {
            display: flex;
            flex-direction: column;
        }

        /* Header */
        .header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            padding: calc(var(--spacing) * 1.25) calc(var(--spacing) * 2);
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            align-items: center;
            gap: var(--spacing);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .header-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--crimson);
            white-space: nowrap;
        }

        .header-center {
            color: var(--text-secondary);
            font-size: 0.875rem;
            text-align: center;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: calc(var(--spacing) / 2);
            justify-content: flex-end;
        }

        .bot-status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--text-tertiary);
            flex-shrink: 0;
        }

        .bot-status-dot.active {
            background: var(--success);
            animation: pulse-dot 2s ease-in-out infinite;
        }

        @keyframes pulse-dot {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .bot-status-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        /* Main Container */
        .container {
            flex: 1;
            max-width: 1600px;
            margin: 0 auto;
            padding: calc(var(--spacing) * 2);
            width: 100%;
        }

        /* Section */
        .section {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-bottom: calc(var(--spacing) * 2);
            overflow: hidden;
        }

        .section-header {
            padding: calc(var(--spacing) * 1.25) calc(var(--spacing) * 1.5);
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .section-title {
            font-size: 1rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--crimson);
        }

        .section-body {
            padding: calc(var(--spacing) * 1.5);
        }

        /* Content Queue Cards */
        .queue-cards {
            display: flex;
            flex-direction: column;
            gap: var(--spacing);
        }

        .queue-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: var(--spacing);
            transition: border-color 0.2s;
        }

        .queue-card.expanded {
            border-color: var(--crimson-dim);
        }

        .queue-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: var(--spacing);
            cursor: pointer;
            padding: calc(var(--spacing) / 2);
            margin: calc(var(--spacing) / -2);
            border-radius: 6px;
            transition: background 0.2s;
        }

        .queue-card-header:hover {
            background: var(--bg-tertiary);
        }

        .queue-card-left {
            flex: 1;
        }

        .queue-card-id {
            font-size: 0.75rem;
            color: var(--text-tertiary);
            font-weight: 600;
            margin-bottom: 4px;
        }

        .queue-card-title {
            font-weight: 600;
            font-size: 1.125rem;
            line-height: 1.4;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .queue-card-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .type-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            font-size: 0.8125rem;
            font-weight: 500;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.8125rem;
            font-weight: 600;
            color: #ffffff;
        }

        .status-draft { background: var(--warning); }
        .status-approved { background: var(--success); }
        .status-posted { background: var(--blue); }
        .status-rejected { background: var(--error); }

        .queue-card-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out, padding 0.3s ease-out;
            padding: 0;
        }

        .queue-card.expanded .queue-card-content {
            max-height: 2000px;
            padding-top: var(--spacing);
            border-top: 1px solid var(--border);
            margin-top: var(--spacing);
        }

        .queue-preview {
            font-size: 0.9375rem;
            line-height: 1.6;
            color: var(--text-primary);
            white-space: pre-wrap;
            word-wrap: break-word;
            margin-bottom: var(--spacing);
        }

        /* Action Buttons */
        .queue-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 8px;
            margin-top: var(--spacing);
        }

        .action-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
            min-height: 44px;
            white-space: nowrap;
        }

        .action-btn:hover:not(:disabled) {
            background: var(--bg-card);
            border-color: var(--crimson);
            transform: translateY(-1px);
        }

        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .action-btn.approve {
            background: var(--success);
            border-color: var(--success);
            color: #ffffff;
        }

        .action-btn.approve:hover:not(:disabled) {
            background: #0d9668;
            border-color: #0d9668;
        }

        .action-btn.reject {
            background: var(--error);
            border-color: var(--error);
            color: #ffffff;
        }

        .action-btn.reject:hover:not(:disabled) {
            background: #dc2626;
            border-color: #dc2626;
        }

        .action-btn.suggest {
            background: var(--warning);
            border-color: var(--warning);
            color: #ffffff;
        }

        .action-btn.suggest:hover:not(:disabled) {
            background: #d97706;
            border-color: #d97706;
        }

        /* Edit/Suggest Editor */
        .edit-editor {
            display: none;
            margin-top: var(--spacing);
            padding: var(--spacing);
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 6px;
        }

        .edit-editor.show {
            display: block;
        }

        .edit-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .edit-textarea {
            width: 100%;
            padding: 12px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 0.9375rem;
            resize: vertical;
            min-height: 100px;
            margin-bottom: 8px;
            transition: border-color 0.2s;
        }

        .edit-textarea:focus {
            outline: none;
            border-color: var(--crimson);
        }

        .edit-buttons {
            display: flex;
            gap: 8px;
        }

        .edit-btn {
            flex: 1;
            padding: 10px;
            background: var(--crimson);
            border: 1px solid var(--crimson);
            border-radius: 6px;
            color: #ffffff;
            font-family: inherit;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            min-height: 40px;
        }

        .edit-btn:hover:not(:disabled) {
            background: var(--crimson-dark);
        }

        .edit-btn.cancel {
            background: var(--bg-tertiary);
            border-color: var(--border);
            color: var(--text-primary);
        }

        .edit-btn.cancel:hover {
            background: var(--bg-card);
        }

        .edit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Loading Spinner */
        .spinner {
            display: inline-block;
            width: 14px;
            height: 14px;
            border: 2px solid rgba(255,255,255,0.3);
            border-top-color: #ffffff;
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 80px;
            right: 20px;
            background: var(--success);
            color: #ffffff;
            padding: 12px 16px;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            z-index: 999;
            display: none;
            align-items: center;
            gap: 8px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.3s ease-out;
            max-width: 300px;
        }

        .toast.show {
            display: flex;
        }

        .toast.error {
            background: var(--error);
        }

        .toast.warning {
            background: var(--warning);
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: calc(var(--spacing) * 4) calc(var(--spacing) * 2);
            color: var(--text-tertiary);
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: var(--spacing);
            opacity: 0.3;
        }

        .empty-state-text {
            font-size: 0.9375rem;
            line-height: 1.5;
        }

        /* Footer */
        .footer {
            border-top: 1px solid var(--border);
            padding: calc(var(--spacing) * 2);
            color: var(--text-tertiary);
            font-size: 0.8125rem;
            text-align: left;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header {
                grid-template-columns: 1fr;
                gap: calc(var(--spacing) / 2);
                padding: var(--spacing);
            }

            .header-center {
                text-align: left;
            }

            .header-right {
                justify-content: flex-start;
            }

            .container {
                padding: var(--spacing);
            }

            .queue-actions {
                grid-template-columns: 1fr;
            }

            .action-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Data Structure -->
    <script>
        // Cloudflare Worker API endpoint
        const API_URL = 'https://design-jutsu-api.your-subdomain.workers.dev';

        const DASHBOARD_DATA = {
            lastUpdated: "2026-02-11T15:55:00.000Z",
            botStatus: "idle",
            reviewMode: true,
            contentQueue: [
                {
                    id: 6,
                    type: "resource",
                    title: "Storyset ‚Äî Free, Customizable Illustrations",
                    channel: "Resources",
                    status: "draft",
                    date: "2026-02-11",
                    preview: "üîß Storyset\nüìÇ Type: Illustration Library\nüí∞ Pricing: Free\nüíª Platform: Web\n\nWhat it does: Free, open-source collection of customizable illustrations for web design. Change colors, add your own elements, export as PNG/SVG. No attribution required.\n\nBest for:\n‚Üí Adding polished visuals to landing pages\n‚Üí Creating consistent illustration style across projects\n\nüîó https://storyset.com"
                },
                {
                    id: 5,
                    type: "resource",
                    title: "Inter Font ‚Äî Typeface for Computer Screens",
                    channel: "Resources",
                    status: "draft",
                    date: "2026-02-10",
                    preview: "üîß Inter\nüìÇ Type: Free Font\nüí∞ Pricing: Free\nüíª Platform: Web\n\nWhat it does: Open-source sans-serif typeface designed specifically for screen use. Metrically compatible with Helvetica, perfect for UIs with great readability at all sizes.\n\nBest for:\n‚Üí App and web UI typography\n‚Üí Accessible interface design\n\nüîó https://rsms.me/inter/"
                },
                {
                    id: 4,
                    type: "resource",
                    title: "Accessibility Insights ‚Äî Web Accessibility Testing",
                    channel: "Resources",
                    status: "draft",
                    date: "2026-02-10",
                    preview: "üîß Accessibility Insights\nüìÇ Type: Accessibility Tool\nüí∞ Pricing: Free\nüíª Platform: Browser Extension\n\nWhat it does: Free browser extension that scans web pages for accessibility issues. Powered by Microsoft ‚Äî gives actionable guidance on WCAG compliance.\n\nBest for:\n‚Üí Testing designs for accessibility\n‚Üí Learning WCAG standards\n\nüîó https://accessibilityinsights.io/"
                },
                {
                    id: 3,
                    type: "resource",
                    title: "Elytra ‚Äî Free UI Component Kit",
                    channel: "Resources",
                    status: "draft",
                    date: "2026-02-10",
                    preview: "üîß Elytra\nüìÇ Type: UI Kit\nüí∞ Pricing: Free\nüíª Platform: Figma\n\nWhat it does: Open-source design system with production-ready components. Fully customizable, accessible, and ready to hand off to developers.\n\nBest for:\n‚Üí Speeding up component design\n‚Üí Learning design system best practices\n\nüîó https://www.elytra.design/"
                }
            ]
        };
    </script>

    <!-- Password Gate -->
    <div class="password-gate" id="passwordGate">
        <div class="password-box">
            <h1 class="password-title">Design Jutsu</h1>
            <p class="password-subtitle">Command Center Access</p>
            <input type="password" class="password-input" id="passwordInput" placeholder="Enter password" autocomplete="off">
            <button class="password-submit" onclick="checkPassword()">Unlock</button>
            <p class="password-error" id="passwordError">Incorrect password</p>
        </div>
    </div>

    <!-- Dashboard -->
    <div class="dashboard" id="dashboard">
        <!-- Header -->
        <header class="header">
            <div class="header-title">Design Jutsu ‚Äî Command Center</div>
            <div class="header-center" id="lastUpdated">Loading...</div>
            <div class="header-right">
                <div class="bot-status-dot" id="botStatusDot"></div>
                <span class="bot-status-label" id="botStatusLabel">Idle</span>
            </div>
        </header>

        <!-- Main Container -->
        <div class="container">
            <!-- Content Queue -->
            <section class="section">
                <div class="section-header">
                    <h2 class="section-title">Content Queue</h2>
                </div>
                <div class="section-body">
                    <div class="queue-cards" id="contentQueue"></div>
                </div>
            </section>
        </div>

        <!-- Footer -->
        <footer class="footer">
            Powered by OpenClaw √ó Cloudflare
        </footer>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast">
        <span id="toastMessage"></span>
    </div>

    <!-- Scripts -->
    <script>
        let expandedCard = null;
        let activeEditor = null;
        let refreshInterval = null;

        // Password check
        function checkPassword() {
            const input = document.getElementById('passwordInput');
            const error = document.getElementById('passwordError');
            
            if (input.value === 'grandmaster') {
                sessionStorage.setItem('djAuth', 'true');
                document.getElementById('passwordGate').style.display = 'none';
                document.getElementById('dashboard').classList.add('unlocked');
                renderDashboard();
                startAutoRefresh();
            } else {
                error.classList.add('show');
                input.value = '';
                setTimeout(() => error.classList.remove('show'), 3000);
            }
        }

        // Enter key support
        document.getElementById('passwordInput')?.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') checkPassword();
        });

        // Check existing auth
        if (sessionStorage.getItem('djAuth') === 'true') {
            document.getElementById('passwordGate').style.display = 'none';
            document.getElementById('dashboard').classList.add('unlocked');
            renderDashboard();
            startAutoRefresh();
        }

        // Format timestamp
        function formatTime(isoString) {
            const date = new Date(isoString);
            const now = new Date();
            const diff = now - date;
            const minutes = Math.floor(diff / 60000);
            
            if (minutes < 1) return 'Just now';
            if (minutes < 60) return `${minutes}m ago`;
            
            const hours = Math.floor(minutes / 60);
            if (hours < 24) return `${hours}h ago`;
            
            return date.toLocaleDateString('en-US', {
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // Toast notifications
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            document.getElementById('toastMessage').textContent = message;
            toast.className = 'toast show ' + type;
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        // API call to Worker
        async function sendCommand(action, id, content = null) {
            try {
                const response = await fetch(`${API_URL}/api/command`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ action, id, content })
                });

                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error || 'Command failed');
                }

                const result = await response.json();
                return result;
            } catch (error) {
                console.error('API error:', error);
                throw error;
            }
        }

        // Action handlers
        async function handleApprove(id) {
            const btn = document.querySelector(`[data-action="approve"][data-id="${id}"]`);
            if (!btn || btn.disabled) return;

            try {
                btn.disabled = true;
                btn.innerHTML = '<span class="spinner"></span> Approving...';
                
                await sendCommand('approve', id);
                
                btn.innerHTML = '‚úì Posted';
                btn.style.background = '#0d9668';
                showToast('‚úì Approval queued for bot execution');

                // Disable all buttons for this item
                disableItemButtons(id);

            } catch (error) {
                btn.disabled = false;
                btn.innerHTML = '‚úÖ Approve';
                showToast('‚úó Failed: ' + error.message, 'error');
            }
        }

        async function handleReject(id) {
            const btn = document.querySelector(`[data-action="reject"][data-id="${id}"]`);
            if (!btn || btn.disabled) return;

            try {
                btn.disabled = true;
                btn.innerHTML = '<span class="spinner"></span> Rejecting...';
                
                await sendCommand('reject', id);
                
                btn.innerHTML = '‚úì Rejected';
                showToast('‚úì Rejection queued for bot execution');

                // Disable all buttons for this item
                disableItemButtons(id);

            } catch (error) {
                btn.disabled = false;
                btn.innerHTML = '‚ùå Reject';
                showToast('‚úó Failed: ' + error.message, 'error');
            }
        }

        async function handleDelete(id) {
            const btn = document.querySelector(`[data-action="delete"][data-id="${id}"]`);
            if (!btn || btn.disabled) return;

            if (!confirm('Delete this item from the queue?')) return;

            try {
                btn.disabled = true;
                btn.innerHTML = '<span class="spinner"></span> Deleting...';
                
                await sendCommand('delete', id);
                
                btn.innerHTML = '‚úì Deleted';
                showToast('‚úì Deletion queued for bot execution');

                // Disable all buttons for this item
                disableItemButtons(id);

            } catch (error) {
                btn.disabled = false;
                btn.innerHTML = 'üóëÔ∏è Delete';
                showToast('‚úó Failed: ' + error.message, 'error');
            }
        }

        function toggleEditor(id, type) {
            const editor = document.getElementById(`editor-${id}`);
            const btn = document.querySelector(`[data-action="${type}"][data-id="${id}"]`);

            if (activeEditor === id) {
                // Close editor
                editor.classList.remove('show');
                activeEditor = null;
            } else {
                // Close any open editor
                if (activeEditor) {
                    document.getElementById(`editor-${activeEditor}`)?.classList.remove('show');
                }
                // Open this editor
                editor.classList.add('show');
                editor.querySelector('textarea').focus();
                activeEditor = id;
            }
        }

        async function saveEdit(id, type) {
            const textarea = document.querySelector(`#editor-${id} textarea`);
            const saveBtn = document.querySelector(`#editor-${id} .edit-btn:not(.cancel)`);
            const content = textarea.value.trim();

            if (!content) {
                showToast('Please enter some text', 'warning');
                return;
            }

            try {
                saveBtn.disabled = true;
                saveBtn.innerHTML = '<span class="spinner"></span> Saving...';
                
                await sendCommand(type, id, content);
                
                saveBtn.innerHTML = '‚úì Saved';
                showToast(`‚úì ${type === 'edit' ? 'Edit' : 'Suggestion'} queued for bot execution`);

                // Close editor after 1s
                setTimeout(() => {
                    document.getElementById(`editor-${id}`).classList.remove('show');
                    activeEditor = null;
                }, 1000);

            } catch (error) {
                saveBtn.disabled = false;
                saveBtn.innerHTML = `Save ${type === 'edit' ? 'Edit' : 'Suggestion'}`;
                showToast('‚úó Failed: ' + error.message, 'error');
            }
        }

        function cancelEdit(id) {
            document.getElementById(`editor-${id}`).classList.remove('show');
            activeEditor = null;
        }

        function disableItemButtons(id) {
            const buttons = document.querySelectorAll(`[data-id="${id}"]`);
            buttons.forEach(btn => {
                if (btn.tagName === 'BUTTON') {
                    btn.disabled = true;
                }
            });
        }

        function toggleCard(id) {
            const card = document.getElementById(`card-${id}`);
            
            if (expandedCard === id) {
                card.classList.remove('expanded');
                expandedCard = null;
            } else {
                // Close previously expanded
                if (expandedCard) {
                    document.getElementById(`card-${expandedCard}`)?.classList.remove('expanded');
                }
                card.classList.add('expanded');
                expandedCard = id;
            }
        }

        function getTypeIcon(type) {
            const icons = {
                bounty: 'üéØ',
                resource: 'üîß',
                discussion: 'üí¨',
                announcement: 'üì¢'
            };
            return icons[type.toLowerCase()] || 'üìÑ';
        }

        // Render dashboard
        function renderDashboard() {
            // Update header
            document.getElementById('lastUpdated').textContent = `Updated ${formatTime(DASHBOARD_DATA.lastUpdated)}`;
            
            const statusDot = document.getElementById('botStatusDot');
            const statusLabel = document.getElementById('botStatusLabel');
            if (DASHBOARD_DATA.botStatus === 'active') {
                statusDot.classList.add('active');
                statusLabel.textContent = 'Active';
            } else {
                statusDot.classList.remove('active');
                statusLabel.textContent = 'Idle';
            }

            // Render content queue
            const container = document.getElementById('contentQueue');
            
            if (DASHBOARD_DATA.contentQueue.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìã</div>
                        <div class="empty-state-text">No content in queue ‚Äî bot will add drafts here for your review</div>
                    </div>
                `;
                return;
            }

            let html = '';
            DASHBOARD_DATA.contentQueue.forEach(item => {
                html += `
                    <div class="queue-card ${expandedCard === item.id ? 'expanded' : ''}" id="card-${item.id}">
                        <div class="queue-card-header" onclick="toggleCard(${item.id})">
                            <div class="queue-card-left">
                                <div class="queue-card-id">#${item.id}</div>
                                <div class="queue-card-title">${item.title}</div>
                                <div class="queue-card-meta">
                                    <span class="type-badge">${getTypeIcon(item.type)} ${item.type}</span>
                                    <span>${item.channel}</span>
                                    <span>${item.date}</span>
                                </div>
                            </div>
                            <span class="status-badge status-${item.status.toLowerCase()}">${item.status.charAt(0).toUpperCase() + item.status.slice(1)}</span>
                        </div>
                        
                        <div class="queue-card-content">
                            <div class="queue-preview">${item.preview || 'No preview available'}</div>
                            
                            <div class="queue-actions">
                                <button class="action-btn approve" data-action="approve" data-id="${item.id}" onclick="handleApprove(${item.id})">
                                    ‚úÖ Approve
                                </button>
                                <button class="action-btn reject" data-action="reject" data-id="${item.id}" onclick="handleReject(${item.id})">
                                    ‚ùå Reject
                                </button>
                                <button class="action-btn" data-action="edit" data-id="${item.id}" onclick="toggleEditor(${item.id}, 'edit')">
                                    ‚úèÔ∏è Edit
                                </button>
                                <button class="action-btn suggest" data-action="suggest" data-id="${item.id}" onclick="toggleEditor(${item.id}, 'suggest')">
                                    üí¨ Suggest
                                </button>
                                <button class="action-btn" data-action="delete" data-id="${item.id}" onclick="handleDelete(${item.id})">
                                    üóëÔ∏è Delete
                                </button>
                            </div>

                            <div class="edit-editor" id="editor-${item.id}">
                                <div class="edit-label">Enter your ${activeEditor === item.id ? 'changes' : 'suggestion'}:</div>
                                <textarea class="edit-textarea" placeholder="Type your ${activeEditor === item.id ? 'edit instructions' : 'suggestions'} here..."></textarea>
                                <div class="edit-buttons">
                                    <button class="edit-btn cancel" onclick="cancelEdit(${item.id})">Cancel</button>
                                    <button class="edit-btn" onclick="saveEdit(${item.id}, activeEditor === ${item.id} ? 'edit' : 'suggest')">Save ${activeEditor === item.id ? 'Edit' : 'Suggestion'}</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // Auto-refresh every 30 seconds
        function startAutoRefresh() {
            refreshInterval = setInterval(async () => {
                try {
                    const response = await fetch(
                        'https://raw.githubusercontent.com/ShobhitPurva/design-jutsu-dashboard/main/index.html',
                        { cache: 'no-store' }
                    );

                    if (response.ok) {
                        const html = await response.text();
                        const match = html.match(/const DASHBOARD_DATA = ({[\s\S]*?});/);
                        
                        if (match) {
                            const newData = eval('(' + match[1] + ')');
                            
                            if (JSON.stringify(newData) !== JSON.stringify(DASHBOARD_DATA)) {
                                Object.assign(DASHBOARD_DATA, newData);
                                renderDashboard();
                                console.log('‚úì Dashboard refreshed');
                            }
                        }
                    }
                } catch (error) {
                    console.error('Auto-refresh error:', error);
                }
            }, 30000); // 30 seconds
        }

        // Initial render
        if (sessionStorage.getItem('djAuth') === 'true') {
            renderDashboard();
        }
    </script>
</body>
</html>
